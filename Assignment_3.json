{"paragraphs":[{"text":"%pyspark\r\nfrom pyspark.sql import SparkSession\r\nfrom pyspark.sql import functions as F\r\nfrom pyspark.sql.types import StructType, StructField, IntegerType, StringType","user":"anonymous","dateUpdated":"2025-06-13T07:47:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1749710620600_-662751345","id":"20250612-064340_1833401777","dateCreated":"2025-06-12T06:43:40+0000","dateStarted":"2025-06-13T07:47:26+0000","dateFinished":"2025-06-13T07:47:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20987"},{"text":"%pyspark\n# Define schema of user\nuser_schema = StructType([\n    StructField(\"user_id\", IntegerType(), True),\n    StructField(\"age\", IntegerType(), True),\n    StructField(\"gender\", StringType(), True),\n    StructField(\"occupation\", StringType(), True),\n    StructField(\"zip_code\", StringType(), True)\n])\n\n# 加载为DataFrame\nusers_df = spark.read \\\n    .option(\"delimiter\", \"|\") \\\n    .schema(user_schema) \\\n    .csv(\"hdfs:///user/maria_dev/ml-100k/u.user\")\nusers_df.show(5)\n","user":"anonymous","dateUpdated":"2025-06-13T07:50:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+--------+\n|user_id|age|gender|occupation|zip_code|\n+-------+---+------+----------+--------+\n|      1| 24|     M|technician|   85711|\n|      2| 53|     F|     other|   94043|\n|      3| 23|     M|    writer|   32067|\n|      4| 24|     M|technician|   43537|\n|      5| 33|     F|     other|   15213|\n+-------+---+------+----------+--------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749800867883_621732833","id":"20250613-074747_647380903","dateCreated":"2025-06-13T07:47:47+0000","dateStarted":"2025-06-13T07:50:15+0000","dateFinished":"2025-06-13T07:50:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20988"},{"text":"%pyspark\r\nitem_schema = StructType([\r\n    StructField(\"movie_id\", IntegerType(), True),\r\n    StructField(\"movie_title\", StringType(), True),\r\n    StructField(\"release_date\", StringType(), True),\r\n    StructField(\"video_release_date\", StringType(), True),\r\n    StructField(\"IMDb_URL\", StringType(), True),\r\n    StructField(\"unknown\", IntegerType(), True),\r\n    StructField(\"Action\", IntegerType(), True),\r\n    StructField(\"Adventure\", IntegerType(), True),\r\n    StructField(\"Animation\", IntegerType(), True),\r\n    StructField(\"Children\", IntegerType(), True),\r\n    StructField(\"Comedy\", IntegerType(), True),\r\n    StructField(\"Crime\", IntegerType(), True),\r\n    StructField(\"Documentary\", IntegerType(), True),\r\n    StructField(\"Drama\", IntegerType(), True),\r\n    StructField(\"Fantasy\", IntegerType(), True),\r\n    StructField(\"Film-Noir\", IntegerType(), True),\r\n    StructField(\"Horror\", IntegerType(), True),\r\n    StructField(\"Musical\", IntegerType(), True),\r\n    StructField(\"Mystery\", IntegerType(), True),\r\n    StructField(\"Romance\", IntegerType(), True),\r\n    StructField(\"Sci-Fi\", IntegerType(), True),\r\n    StructField(\"Thriller\", IntegerType(), True),\r\n    StructField(\"War\", IntegerType(), True),\r\n    StructField(\"Western\", IntegerType(), True),\r\n])\r\n\r\nitems_df = spark.read \\\r\n    .option(\"delimiter\", \"|\") \\\r\n    .schema(item_schema) \\\r\n    .csv(\"hdfs:///user/maria_dev/ml-100k/u.item\")\r\n\r\nitems_df.show(5)\r\n","user":"anonymous","dateUpdated":"2025-06-13T07:56:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------------+------------+------------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|movie_id|      movie_title|release_date|video_release_date|            IMDb_URL|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|Film-Noir|Horror|Musical|Mystery|Romance|Sci-Fi|Thriller|War|Western|\n+--------+-----------------+------------+------------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|       1| Toy Story (1995)| 01-Jan-1995|              null|http://us.imdb.co...|      0|     0|        0|        1|       1|     1|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       0|  0|      0|\n|       2| GoldenEye (1995)| 01-Jan-1995|              null|http://us.imdb.co...|      0|     1|        1|        0|       0|     0|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n|       3|Four Rooms (1995)| 01-Jan-1995|              null|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n|       4|Get Shorty (1995)| 01-Jan-1995|              null|http://us.imdb.co...|      0|     1|        0|        0|       0|     1|    0|          0|    1|      0|        0|     0|      0|      0|      0|     0|       0|  0|      0|\n|       5|   Copycat (1995)| 01-Jan-1995|              null|http://us.imdb.co...|      0|     0|        0|        0|       0|     0|    1|          0|    1|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n+--------+-----------------+------------+------------------+--------------------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749712783586_-28099256","id":"20250612-071943_822847646","dateCreated":"2025-06-12T07:19:43+0000","dateStarted":"2025-06-13T07:56:33+0000","dateFinished":"2025-06-13T07:56:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20989"},{"text":"%pyspark\r\ndata_schema = StructType([\r\n    StructField(\"user_id\", IntegerType(), True),\r\n    StructField(\"movie_id\", IntegerType(), True),\r\n    StructField(\"rating\", IntegerType(), True),\r\n    StructField(\"timestamp\", IntegerType(), True)\r\n])\r\n\r\nratings_df = spark.read \\\r\n    .option(\"delimiter\", \"\\t\") \\\r\n    .schema(data_schema) \\\r\n    .csv(\"hdfs:///user/maria_dev/ml-100k/u.data\")\r\n\r\nratings_df.show(5)","user":"anonymous","dateUpdated":"2025-06-13T07:58:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------+------+---------+\n|user_id|movie_id|rating|timestamp|\n+-------+--------+------+---------+\n|    196|     242|     3|881250949|\n|    186|     302|     3|891717742|\n|     22|     377|     1|878887116|\n|    244|      51|     2|880606923|\n|    166|     346|     1|886397596|\n+-------+--------+------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749710896767_595360589","id":"20250612-064816_132103030","dateCreated":"2025-06-12T06:48:16+0000","dateStarted":"2025-06-13T07:58:51+0000","dateFinished":"2025-06-13T07:58:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20990"},{"text":"%pyspark\nuser_df.createOrReplaceTempView(\"users\")\nitem_df.createOrReplaceTempView(\"items\")\nrating_df.createOrReplaceTempView(\"ratings\")","user":"anonymous","dateUpdated":"2025-06-13T07:59:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1749711017366_-2060375533","id":"20250612-065017_1262819177","dateCreated":"2025-06-12T06:50:17+0000","dateStarted":"2025-06-13T07:59:52+0000","dateFinished":"2025-06-13T07:59:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20991"},{"text":"%md\n## i) Calculate the Average Rating for Each Movie","user":"anonymous","dateUpdated":"2025-06-13T08:52:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>i) Calculate the Average Rating for Each Movie</h2>\n"}]},"apps":[],"jobName":"paragraph_1749804703897_-787537278","id":"20250613-085143_693071539","dateCreated":"2025-06-13T08:51:43+0000","dateStarted":"2025-06-13T08:52:31+0000","dateFinished":"2025-06-13T08:52:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20992"},{"text":"%pyspark\navg_rating_with_name_df = spark.sql(\"\"\"\n    SELECT\n        i.movie_id,\n        i.movie_title,\n        AVG(r.rating) AS avg_rating,\n        COUNT(*) AS rating_count\n    FROM ratings r\n    JOIN items i ON r.movie_id = i.movie_id\n    GROUP BY i.movie_id, i.movie_title\n    ORDER BY i.movie_id\n\"\"\")\navg_rating_with_name_df.show(10, truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T08:08:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------------------------------------------------+------------------+------------+\n|movie_id|movie_title                                         |avg_rating        |rating_count|\n+--------+----------------------------------------------------+------------------+------------+\n|1       |Toy Story (1995)                                    |3.8783185840707963|452         |\n|2       |GoldenEye (1995)                                    |3.2061068702290076|131         |\n|3       |Four Rooms (1995)                                   |3.033333333333333 |90          |\n|4       |Get Shorty (1995)                                   |3.550239234449761 |209         |\n|5       |Copycat (1995)                                      |3.302325581395349 |86          |\n|6       |Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)|3.576923076923077 |26          |\n|7       |Twelve Monkeys (1995)                               |3.798469387755102 |392         |\n|8       |Babe (1995)                                         |3.9954337899543377|219         |\n|9       |Dead Man Walking (1995)                             |3.8963210702341136|299         |\n|10      |Richard III (1995)                                  |3.831460674157303 |89          |\n+--------+----------------------------------------------------+------------------+------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749712946716_-2106699993","id":"20250612-072226_1138726021","dateCreated":"2025-06-12T07:22:26+0000","dateStarted":"2025-06-13T08:08:39+0000","dateFinished":"2025-06-13T08:08:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20993"},{"text":"%md\r\nIn this step, I want to calculate the average rating for each movie in the dataset.  \r\nI use a SQL query to join the ratings table and the items table. The ratings table provides all the user ratings, and the items table contains information about each movie, including the title.\r\n\r\nFor each movie, I group the ratings by the movie ID and movie title. I then calculate the average rating and the total number of ratings for each movie.  \r\nThis allows me to see not only how well a movie is rated on average, but also how many users have contributed to its score.\r\n\r\nAfter running the query, I display the results in a table. This table shows the movie ID, the movie title, the average rating, and the number of ratings for each movie.  \r\nBy looking at these results, I can quickly understand which movies are popular and how they are received by the audience.","user":"anonymous","dateUpdated":"2025-06-13T09:19:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this step, I want to calculate the average rating for each movie in the dataset.\n<br  />I use a SQL query to join the ratings table and the items table. The ratings table provides all the user ratings, and the items table contains information about each movie, including the title.</p>\n<p>For each movie, I group the ratings by the movie ID and movie title. I then calculate the average rating and the total number of ratings for each movie.\n<br  />This allows me to see not only how well a movie is rated on average, but also how many users have contributed to its score.</p>\n<p>After running the query, I display the results in a table. This table shows the movie ID, the movie title, the average rating, and the number of ratings for each movie.\n<br  />By looking at these results, I can quickly understand which movies are popular and how they are received by the audience.</p>\n"}]},"apps":[],"jobName":"paragraph_1749806336984_-1387615867","id":"20250613-091856_1089353708","dateCreated":"2025-06-13T09:18:56+0000","dateStarted":"2025-06-13T09:19:19+0000","dateFinished":"2025-06-13T09:19:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20994"},{"text":"%md\n## ii) Identifying the Top Ten Movies with the Highest Average Ratings","user":"anonymous","dateUpdated":"2025-06-13T08:52:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>ii) Identifying the Top Ten Movies with the Highest Average Ratings</h2>\n"}]},"apps":[],"jobName":"paragraph_1749803131162_-592903596","id":"20250613-082531_444800535","dateCreated":"2025-06-13T08:25:31+0000","dateStarted":"2025-06-13T08:52:47+0000","dateFinished":"2025-06-13T08:52:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20995"},{"text":"%pyspark\r\ntop10_movies_df = spark.sql(\"\"\"\r\n    SELECT\r\n        i.movie_id,\r\n        i.movie_title,\r\n        AVG(r.rating) AS avg_rating,\r\n        COUNT(*) AS rating_count\r\n    FROM ratings r\r\n    JOIN items i ON r.movie_id = i.movie_id\r\n    GROUP BY i.movie_id, i.movie_title\r\n    HAVING rating_count >= 50\r\n    ORDER BY avg_rating DESC, rating_count DESC\r\n    LIMIT 10\r\n\"\"\")\r\ntop10_movies_df.show(truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T08:13:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------------------------------------------------------+------------------+------------+\n|movie_id|movie_title                                           |avg_rating        |rating_count|\n+--------+------------------------------------------------------+------------------+------------+\n|408     |Close Shave, A (1995)                                 |4.491071428571429 |112         |\n|318     |Schindler's List (1993)                               |4.466442953020135 |298         |\n|169     |Wrong Trousers, The (1993)                            |4.466101694915254 |118         |\n|483     |Casablanca (1942)                                     |4.45679012345679  |243         |\n|114     |Wallace & Gromit: The Best of Aardman Animation (1996)|4.447761194029851 |67          |\n|64      |Shawshank Redemption, The (1994)                      |4.445229681978798 |283         |\n|603     |Rear Window (1954)                                    |4.3875598086124405|209         |\n|12      |Usual Suspects, The (1995)                            |4.385767790262173 |267         |\n|50      |Star Wars (1977)                                      |4.3584905660377355|583         |\n|178     |12 Angry Men (1957)                                   |4.344             |125         |\n+--------+------------------------------------------------------+------------------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1749711600411_1181910026","id":"20250612-070000_1260473448","dateCreated":"2025-06-12T07:00:00+0000","dateStarted":"2025-06-13T08:13:22+0000","dateFinished":"2025-06-13T08:13:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20996"},{"text":"%md\nIn this step, I aim to find the top ten movies with the highest average ratings.  \nI use SQL to aggregate the movie ratings data. First, I join the `ratings` and `items` tables. The `ratings` table contains user ratings for each movie. The `items` table provides the movie titles and other metadata.\n\nI group the data by `movie_id` and `movie_title`. For each group, I calculate the average rating and the total number of ratings.  \nThe average rating shows how much users enjoyed a particular movie. The rating count tells me how many users contributed to this score.\n\nAfter grouping and aggregation, I sort the movies in descending order by their average rating. I use the `LIMIT 10` clause to select only the top ten movies.  \nThis approach highlights the highest-rated movies in the dataset.\n\nIt is important to note that I can add an extra filter on the rating count. For example, I might only consider movies that have received at least 50 ratings.  \nThis filter helps to avoid bias from movies with very few but very high ratings. For now, I display the top ten movies based only on their average scores.\n\nThe output table presents the movie ID, the movie title, the average rating, and the number of ratings for each of the top ten movies.  \nThis table gives a quick overview of the most popular and well-received movies in the MovieLens dataset.","user":"anonymous","dateUpdated":"2025-06-13T08:26:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this step, I aim to find the top ten movies with the highest average ratings.\n<br  />I use SQL to aggregate the movie ratings data. First, I join the <code>ratings</code> and <code>items</code> tables. The <code>ratings</code> table contains user ratings for each movie. The <code>items</code> table provides the movie titles and other metadata.</p>\n<p>I group the data by <code>movie_id</code> and <code>movie_title</code>. For each group, I calculate the average rating and the total number of ratings.\n<br  />The average rating shows how much users enjoyed a particular movie. The rating count tells me how many users contributed to this score.</p>\n<p>After grouping and aggregation, I sort the movies in descending order by their average rating. I use the <code>LIMIT 10</code> clause to select only the top ten movies.\n<br  />This approach highlights the highest-rated movies in the dataset.</p>\n<p>It is important to note that I can add an extra filter on the rating count. For example, I might only consider movies that have received at least 50 ratings.\n<br  />This filter helps to avoid bias from movies with very few but very high ratings. For now, I display the top ten movies based only on their average scores.</p>\n<p>The output table presents the movie ID, the movie title, the average rating, and the number of ratings for each of the top ten movies.\n<br  />This table gives a quick overview of the most popular and well-received movies in the MovieLens dataset.</p>\n"}]},"apps":[],"jobName":"paragraph_1749803200174_-1020066821","id":"20250613-082640_2095750754","dateCreated":"2025-06-13T08:26:40+0000","dateStarted":"2025-06-13T08:26:57+0000","dateFinished":"2025-06-13T08:26:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20997"},{"text":"%md\n## iii) Find the users who have rated at least 50 movies and identify their favourite movie genres","user":"anonymous","dateUpdated":"2025-06-13T08:30:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>iii) Find the users who have rated at least 50 movies and identify their favourite movie genres</h2>\n"}]},"apps":[],"jobName":"paragraph_1749803368954_-1790305115","id":"20250613-082928_886830345","dateCreated":"2025-06-13T08:29:28+0000","dateStarted":"2025-06-13T08:30:48+0000","dateFinished":"2025-06-13T08:30:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20998"},{"text":"%md\n### Find users with ≥50 ratings","user":"anonymous","dateUpdated":"2025-06-13T08:32:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Find users with ≥50 ratings</h3>\n"}]},"apps":[],"jobName":"paragraph_1749803456506_925960823","id":"20250613-083056_566727652","dateCreated":"2025-06-13T08:30:56+0000","dateStarted":"2025-06-13T08:32:34+0000","dateFinished":"2025-06-13T08:32:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20999"},{"text":"%pyspark\nactive_users_df = spark.sql(\"\"\"\n    SELECT\n        user_id,\n        COUNT(*) AS num_rated_movies\n    FROM ratings\n    GROUP BY user_id\n    HAVING num_rated_movies >= 50\n\"\"\")\nactive_users_df.createOrReplaceTempView(\"active_users\")\nactive_users_df.show(10)","user":"anonymous","dateUpdated":"2025-06-13T08:33:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------------+\n|user_id|num_rated_movies|\n+-------+----------------+\n|    148|              65|\n|    463|             133|\n|    496|             129|\n|    833|             267|\n|    243|              81|\n|    392|             111|\n|    540|              63|\n|    897|             185|\n|    251|              77|\n|     85|             288|\n+-------+----------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749713028723_-1517125116","id":"20250612-072348_2002490208","dateCreated":"2025-06-12T07:23:48+0000","dateStarted":"2025-06-13T08:33:00+0000","dateFinished":"2025-06-13T08:33:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21000"},{"text":"%md\n### The number of movie ratings per genre by each active user","user":"anonymous","dateUpdated":"2025-06-13T08:41:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>The number of movie ratings per genre by each active user</h3>\n"}]},"apps":[],"jobName":"paragraph_1749803587181_-340431697","id":"20250613-083307_411956839","dateCreated":"2025-06-13T08:33:07+0000","dateStarted":"2025-06-13T08:41:54+0000","dateFinished":"2025-06-13T08:41:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21001"},{"text":"%pyspark\r\nuser_genre_count_df = spark.sql(\"\"\"\r\n    SELECT\r\n        r.user_id,\r\n        SUM(i.`unknown`) AS `unknown`,\r\n        SUM(i.`Action`) AS `Action`,\r\n        SUM(i.`Adventure`) AS `Adventure`,\r\n        SUM(i.`Animation`) AS `Animation`,\r\n        SUM(i.`Children`) AS `Children`,\r\n        SUM(i.`Comedy`) AS `Comedy`,\r\n        SUM(i.`Crime`) AS `Crime`,\r\n        SUM(i.`Documentary`) AS `Documentary`,\r\n        SUM(i.`Drama`) AS `Drama`,\r\n        SUM(i.`Fantasy`) AS `Fantasy`,\r\n        SUM(i.`Film-Noir`) AS `Film-Noir`,\r\n        SUM(i.`Horror`) AS `Horror`,\r\n        SUM(i.`Musical`) AS `Musical`,\r\n        SUM(i.`Mystery`) AS `Mystery`,\r\n        SUM(i.`Romance`) AS `Romance`,\r\n        SUM(i.`Sci-Fi`) AS `Sci-Fi`,\r\n        SUM(i.`Thriller`) AS `Thriller`,\r\n        SUM(i.`War`) AS `War`,\r\n        SUM(i.`Western`) AS `Western`\r\n    FROM ratings r\r\n    JOIN items i ON r.movie_id = i.movie_id\r\n    JOIN active_users u ON r.user_id = u.user_id\r\n    GROUP BY r.user_id\r\n\"\"\")\r\n\r\nuser_genre_count_df.createOrReplaceTempView(\"user_genre_count\")\r\nuser_genre_count_df.show(10)\r\n","user":"anonymous","dateUpdated":"2025-06-13T08:38:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|user_id|unknown|Action|Adventure|Animation|Children|Comedy|Crime|Documentary|Drama|Fantasy|Film-Noir|Horror|Musical|Mystery|Romance|Sci-Fi|Thriller|War|Western|\n+-------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|    148|      0|    12|       15|       14|      15|    20|    3|          0|   25|      0|        1|     2|     11|      2|      9|    13|       5| 10|      1|\n|    463|      0|    21|       15|        5|      17|    50|    8|          1|   59|      2|        1|     2|      7|      3|     35|     9|      17|  9|      0|\n|    496|      0|    32|       24|        8|      21|    28|    6|          0|   52|      2|        2|     9|     15|      7|     22|    25|      30| 12|      2|\n|    833|      1|    72|       30|        3|       2|    65|   35|          3|   97|      2|        9|    31|      5|     10|     26|    47|      72| 22|      6|\n|    243|      0|     6|        4|        1|       6|    27|    3|          1|   59|      1|        0|     1|      0|      1|     26|     2|       4|  8|      1|\n|    392|      0|    20|       12|        5|       4|    28|   11|          3|   57|      0|        3|     2|      6|      9|     22|    11|      19| 11|      2|\n|    540|      0|    19|        8|        5|       4|    16|    6|          0|   28|      1|        0|     1|      2|      2|     11|    12|      16|  7|      0|\n|    897|      0|    57|       35|       11|      26|    56|   12|          0|   55|      5|        3|    14|     15|      6|     32|    28|      40| 20|     10|\n|    251|      0|    31|       17|        3|       5|    20|    5|          1|   23|      1|        0|     3|      3|      2|     16|    14|      26|  7|      0|\n|     85|      0|    46|       32|       10|      23|    87|   11|          2|  152|      2|        5|     4|     24|     14|     52|    26|      29| 33|      8|\n+-------+-------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749803587043_9689802","id":"20250613-083307_1579318554","dateCreated":"2025-06-13T08:33:07+0000","dateStarted":"2025-06-13T08:38:29+0000","dateFinished":"2025-06-13T08:38:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21002"},{"text":"%md\n### Find out each user's favorite movie genre","user":"anonymous","dateUpdated":"2025-06-13T08:42:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Find out each user's favorite movie genre</h3>\n"}]},"apps":[],"jobName":"paragraph_1749804138585_1868772417","id":"20250613-084218_47370255","dateCreated":"2025-06-13T08:42:18+0000","dateStarted":"2025-06-13T08:42:33+0000","dateFinished":"2025-06-13T08:42:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21003"},{"text":"%pyspark\nfrom pyspark.sql.types import StringType, IntegerType\nfrom pyspark.sql.functions import udf\n\ngenres = [\n    \"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children\", \"Comedy\",\n    \"Crime\", \"Documentary\", \"Drama\", \"Fantasy\", \"Film-Noir\", \"Horror\",\n    \"Musical\", \"Mystery\", \"Romance\", \"Sci-Fi\", \"Thriller\", \"War\", \"Western\"\n]\n\ndef fav_genre_and_count(*cols):\n    # cols: 19 types of ratings\n    counts = list(cols)\n    max_count = max(counts)\n    favs = [genres[i] for i, v in enumerate(counts) if v == max_count]\n    return \",\".join(favs)\n\nfav_genre_udf = udf(fav_genre_and_count, StringType())\n\n# Pass the 19 fields into the udf one by one\nuser_genre_count_df = user_genre_count_df.withColumn(\n    \"fav_genre\",\n    fav_genre_udf(*[user_genre_count_df[g] for g in genres])\n)\n\n# output max_count\ndef max_count_only(*cols):\n    return int(max(list(cols)))\nmax_count_udf = udf(max_count_only, IntegerType())\nuser_genre_count_df = user_genre_count_df.withColumn(\n    \"max_count\",\n    max_count_udf(*[user_genre_count_df[g] for g in genres])\n)\n\n# Display results\nuser_genre_count_df.select(\"user_id\", \"fav_genre\", \"max_count\").show(10, truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T08:47:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+---------+\n|user_id|fav_genre|max_count|\n+-------+---------+---------+\n|148    |Drama    |25       |\n|463    |Drama    |59       |\n|496    |Drama    |52       |\n|833    |Drama    |97       |\n|243    |Drama    |59       |\n|392    |Drama    |57       |\n|540    |Drama    |28       |\n|897    |Action   |57       |\n|251    |Action   |31       |\n|85     |Drama    |152      |\n+-------+---------+---------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749804136988_-1378923697","id":"20250613-084216_2030438176","dateCreated":"2025-06-13T08:42:16+0000","dateStarted":"2025-06-13T08:47:38+0000","dateFinished":"2025-06-13T08:47:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21004"},{"text":"%md\r\nIn this step, I want to find the users who have rated at least 50 movies.  \r\nFirst, I count the total number of movies each user has rated. If a user has rated 50 or more movies, I consider this user as active.\r\n\r\nNext, I analyze the movie preferences of each active user. I join the ratings data with the movie genres information. For each user, I count how many times they have rated movies in each genre. Each genre represents a specific type of movie, such as Action, Comedy, or Drama.\r\n\r\nAfter I finish counting, I compare the results for all genres. I identify the favourite genre for each user as the one with the highest rating count. If a user has more than one genre with the same highest count, I list all these genres as their favourites.\r\n\r\nThis approach helps me understand what types of movies each active user prefers most.  \r\nBy focusing on users with many ratings, I can provide a more accurate analysis of their personal movie taste.\r\n","user":"anonymous","dateUpdated":"2025-06-13T08:51:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this step, I want to find the users who have rated at least 50 movies.\n<br  />First, I count the total number of movies each user has rated. If a user has rated 50 or more movies, I consider this user as active.</p>\n<p>Next, I analyze the movie preferences of each active user. I join the ratings data with the movie genres information. For each user, I count how many times they have rated movies in each genre. Each genre represents a specific type of movie, such as Action, Comedy, or Drama.</p>\n<p>After I finish counting, I compare the results for all genres. I identify the favourite genre for each user as the one with the highest rating count. If a user has more than one genre with the same highest count, I list all these genres as their favourites.</p>\n<p>This approach helps me understand what types of movies each active user prefers most.\n<br  />By focusing on users with many ratings, I can provide a more accurate analysis of their personal movie taste.</p>\n"}]},"apps":[],"jobName":"paragraph_1749804487769_-1588305364","id":"20250613-084807_1925885735","dateCreated":"2025-06-13T08:48:07+0000","dateStarted":"2025-06-13T08:51:09+0000","dateFinished":"2025-06-13T08:51:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21005"},{"text":"%md\n## iv) Find all the users who are less than 20 years old","user":"anonymous","dateUpdated":"2025-06-13T08:54:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>iv) Find all the users who are less than 20 years old</h2>\n"}]},"apps":[],"jobName":"paragraph_1749804880872_-151853830","id":"20250613-085440_1282254917","dateCreated":"2025-06-13T08:54:40+0000","dateStarted":"2025-06-13T08:54:53+0000","dateFinished":"2025-06-13T08:54:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21006"},{"text":"%md\n### Use SQL to query all users under 20 years old","user":"anonymous","dateUpdated":"2025-06-13T08:55:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Use SQL to query all users under 20 years old</h3>\n"}]},"apps":[],"jobName":"paragraph_1749804904663_-898620797","id":"20250613-085504_1421297462","dateCreated":"2025-06-13T08:55:04+0000","dateStarted":"2025-06-13T08:55:23+0000","dateFinished":"2025-06-13T08:55:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21007"},{"text":"%pyspark\nusers_under_20_df = spark.sql(\"\"\"\n    SELECT *\n    FROM users\n    WHERE age < 20\n\"\"\")\nusers_under_20_df.show(10, truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T08:55:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+-------------+--------+\n|user_id|age|gender|occupation   |zip_code|\n+-------+---+------+-------------+--------+\n|30     |7  |M     |student      |55436   |\n|36     |19 |F     |student      |93117   |\n|52     |18 |F     |student      |55105   |\n|57     |16 |M     |none         |84010   |\n|67     |17 |M     |student      |60402   |\n|68     |19 |M     |student      |22904   |\n|101    |15 |M     |student      |05146   |\n|110    |19 |M     |student      |77840   |\n|142    |13 |M     |other        |48118   |\n|179    |15 |M     |entertainment|20755   |\n+-------+---+------+-------------+--------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749804487410_-1350145795","id":"20250613-084807_1548087083","dateCreated":"2025-06-13T08:48:07+0000","dateStarted":"2025-06-13T08:55:34+0000","dateFinished":"2025-06-13T08:55:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21008"},{"text":"%md\n### Statistics on gender and occupation distribution of users under 20 years old","user":"anonymous","dateUpdated":"2025-06-13T09:02:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Statistics on gender and occupation distribution of users under 20 years old</h3>\n"}]},"apps":[],"jobName":"paragraph_1749804487185_-1363612006","id":"20250613-084807_1518406468","dateCreated":"2025-06-13T08:48:07+0000","dateStarted":"2025-06-13T09:02:05+0000","dateFinished":"2025-06-13T09:02:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21009"},{"text":"%pyspark\nspark.sql(\"\"\"\n    SELECT gender, occupation, COUNT(*) AS cnt\n    FROM users\n    WHERE age < 20\n    GROUP BY gender, occupation\n    ORDER BY cnt DESC\n\"\"\").show(truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T09:01:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------------+---+\n|gender|occupation   |cnt|\n+------+-------------+---+\n|M     |student      |37 |\n|F     |student      |27 |\n|M     |none         |3  |\n|M     |other        |3  |\n|M     |entertainment|2  |\n|F     |writer       |2  |\n|F     |artist       |1  |\n|F     |salesman     |1  |\n|F     |other        |1  |\n+------+-------------+---+\n\n"}]},"apps":[],"jobName":"paragraph_1749805211315_-1731233862","id":"20250613-090011_80113021","dateCreated":"2025-06-13T09:00:11+0000","dateStarted":"2025-06-13T09:00:18+0000","dateFinished":"2025-06-13T09:00:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21010"},{"text":"%md\nIn this step, I want to identify all users who are younger than 20 years old.  \nI use a simple SQL query to filter the users table. I select only those users whose age is less than 20.\n\nBy doing this, I quickly get a list of teenage users in the dataset.  \nI can use this information to study the behavior or preferences of younger users. If needed, I can also explore their gender and occupation distributions.\n\nThis step helps me understand the composition of the user base in terms of age.  \nIt also allows me to perform further analysis focused on the youngest users in the MovieLens dataset.","user":"anonymous","dateUpdated":"2025-06-13T09:04:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this step, I want to identify all users who are younger than 20 years old.\n<br  />I use a simple SQL query to filter the users table. I select only those users whose age is less than 20.</p>\n<p>By doing this, I quickly get a list of teenage users in the dataset.\n<br  />I can use this information to study the behavior or preferences of younger users. If needed, I can also explore their gender and occupation distributions.</p>\n<p>This step helps me understand the composition of the user base in terms of age.\n<br  />It also allows me to perform further analysis focused on the youngest users in the MovieLens dataset.</p>\n"}]},"apps":[],"jobName":"paragraph_1749805094385_1002670874","id":"20250613-085814_1955861266","dateCreated":"2025-06-13T08:58:14+0000","dateStarted":"2025-06-13T09:04:39+0000","dateFinished":"2025-06-13T09:04:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21011"},{"text":"%md\n## v) Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.","user":"anonymous","dateUpdated":"2025-06-13T08:59:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>v) Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.</h2>\n"}]},"apps":[],"jobName":"paragraph_1749805166302_516271643","id":"20250613-085926_1600760694","dateCreated":"2025-06-13T08:59:26+0000","dateStarted":"2025-06-13T08:59:56+0000","dateFinished":"2025-06-13T08:59:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21012"},{"text":"%md\n### Use SQL to filter","user":"anonymous","dateUpdated":"2025-06-13T09:12:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Use SQL to filter</h3>\n"}]},"apps":[],"jobName":"paragraph_1749805828257_328832698","id":"20250613-091028_1296579157","dateCreated":"2025-06-13T09:10:28+0000","dateStarted":"2025-06-13T09:12:57+0000","dateFinished":"2025-06-13T09:12:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21013"},{"text":"%pyspark\nscientists_30_40_df = spark.sql(\"\"\"\n    SELECT *\n    FROM users\n    WHERE occupation = 'scientist' AND age BETWEEN 30 AND 40\n\"\"\")\nscientists_30_40_df.show(10, truncate=False)","user":"anonymous","dateUpdated":"2025-06-13T09:10:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+--------+\n|user_id|age|gender|occupation|zip_code|\n+-------+---+------+----------+--------+\n|40     |38 |M     |scientist |27514   |\n|71     |39 |M     |scientist |98034   |\n|74     |39 |M     |scientist |T8H1N   |\n|107    |39 |M     |scientist |60466   |\n|183    |33 |M     |scientist |27708   |\n|272    |33 |M     |scientist |53706   |\n|309    |40 |M     |scientist |70802   |\n|337    |37 |M     |scientist |10522   |\n|430    |38 |M     |scientist |98199   |\n|538    |31 |M     |scientist |21010   |\n+-------+---+------+----------+--------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1749805093502_1048455993","id":"20250613-085813_1845223215","dateCreated":"2025-06-13T08:58:13+0000","dateStarted":"2025-06-13T09:10:44+0000","dateFinished":"2025-06-13T09:10:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21014"},{"text":"%md\n### Count","user":"anonymous","dateUpdated":"2025-06-13T09:13:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Count</h3>\n"}]},"apps":[],"jobName":"paragraph_1749805969584_723949038","id":"20250613-091249_282510396","dateCreated":"2025-06-13T09:12:49+0000","dateStarted":"2025-06-13T09:13:56+0000","dateFinished":"2025-06-13T09:13:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21015"},{"text":"%pyspark\ncount = scientists_30_40_df.count()\nprint(\"Number of scientists aged 30 to 40: \" + str(count))","user":"anonymous","dateUpdated":"2025-06-13T09:12:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Number of scientists aged 30 to 40: 16\n"}]},"apps":[],"jobName":"paragraph_1749804485606_-2047310802","id":"20250613-084805_1489898422","dateCreated":"2025-06-13T08:48:05+0000","dateStarted":"2025-06-13T09:12:43+0000","dateFinished":"2025-06-13T09:12:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21016"},{"text":"%md\nIn this step, I look for users whose occupation is \"scientist\" and whose age is between 30 and 40 years old，final statistics \nI use a SQL query to filter the users table. I select only those users who match both conditions.\n\nThis method allows me to focus on a very specific group of users in the dataset.  \nBy identifying scientists within this age range, I can analyze their movie preferences or compare them with other groups.","user":"anonymous","dateUpdated":"2025-06-13T09:16:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this step, I look for users whose occupation is &ldquo;scientist&rdquo; and whose age is between 30 and 40 years old，final statistics\n<br  />I use a SQL query to filter the users table. I select only those users who match both conditions.</p>\n<p>This method allows me to focus on a very specific group of users in the dataset.\n<br  />By identifying scientists within this age range, I can analyze their movie preferences or compare them with other groups.</p>\n"}]},"apps":[],"jobName":"paragraph_1749805921374_-756605245","id":"20250613-091201_1306248386","dateCreated":"2025-06-13T09:12:01+0000","dateStarted":"2025-06-13T09:16:29+0000","dateFinished":"2025-06-13T09:16:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21017"},{"text":"%md\n","user":"anonymous","dateUpdated":"2025-06-13T09:19:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749806387061_-388145494","id":"20250613-091947_714516770","dateCreated":"2025-06-13T09:19:47+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21018"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-13T09:11:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749805919477_-1505711354","id":"20250613-091159_1485330411","dateCreated":"2025-06-13T09:11:59+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21019"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-13T09:11:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749805918932_-1296023203","id":"20250613-091158_928540402","dateCreated":"2025-06-13T09:11:58+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21020"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749803774214_2021601453","id":"20250613-083614_2134761519","dateCreated":"2025-06-13T08:36:14+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21021"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-12T07:05:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749711926939_1615413122","id":"20250612-070526_92965248","dateCreated":"2025-06-12T07:05:26+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21022"}],"name":"Assignment_3","id":"2KVRGDGAZ","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}